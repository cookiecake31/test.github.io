<html>
<head>
  <meta charset="UTF-8">
  <title>ฟอร์มนักเรียน ม.1–2</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Itim&display=swap" rel="stylesheet">
<style>
  body{font-family: "Itim", cursive;
  font-weight: 400;
  font-style: normal;}
</style>
</head>
<body background="https://png.pngtree.com/background/20210715/original/pngtree-cute-cartoon-pattern-background-picture-image_1276195.jpg">
<center>
  <h1 style="color:darkblue;">ฟอร์มสำหรับนักเรียน ม.1-2</h1>
  <form id="studentForm">
    <label>ชื่อ-นามสกุล
      <input type="text" name="fullname" placeholder="ใส่ชื่อ-นามสกุล">
    </label>
<br><br>
    <label>อายุ
      <input type="number" name="age" min="12" max="15" placeholder="ใส่อายุ">
    </label>
<br><br>
    <label>ห้องเรียน
      <select name="classroom">
        <option value="">-- เลือกห้องเรียน --</option>
        <option value="ม.1/1">ม.1/1</option>
        <option value="ม.1/2">ม.1/2</option>
        <option value="ม.2/1">ม.2/1</option>
        <option value="ม.2/2">ม.2/2</option>
      </select>
    </label>
<br><br>
    <label>ความคิดเห็น
      <textarea name="comment" rows="4" placeholder="ใส่ความคิดเห็นของคุณ"></textarea>
    </label>
<br><br>
    <button type="submit" >ส่งข้อมูล</button>
</form>
  <p id="response"></p>

<script>
  const form =document.getElementbyId('studentform');
  const form =document.getElementbyId('response');

 //ป้องกันหน้าเว็บโหลดใหม่
  form.onsubmit = e =>
    {  e.preventDefault();
  //ส่ง post ไปที่ url google script
     fetch('https://script.google.com/macros/s/AKfycbyRuDz938S8H0gkbyRQ_7nx1vhkVQ2mQ6b1nFhjRqFzjt1iKgVzFbVq5Tgqmaydh_rI/exec', 
{ method: 'POST',
    body: new URLSearchParams(new FormData(form))
  })

       //หากสำเร็จจะส่งข้อมูล
    .then(() => {
    responseEl.textContent = "ส่งข้อมูลสำเร็จ ขอบคุณนะ!";
    form.reset();
  })
 
       //ถ้าเกิดข้อผิดพลาด
    .catch(() => responseEl.textContent = "เกิดข้อผิดพลาดในการส่งข้อมูล ลองใหม่อีกครั้ง");
};
</script>
